# 4.4 명령어 Fast-Forward merge, 3-way merge, rebase

### 4.4.1 Fast-Forward
Fast-Forward 깃의 가장 간단한 브랜치 병합방식이며 풀어서 쓰면 **빨리감기**라고 할 수 있다. 

Fast-Forward의 예시를 간단하게 실행해보겠다. 

![image](https://user-images.githubusercontent.com/106071689/201470792-99332476-7e91-4462-bc3a-7c6587c5f5b2.png)

병합 준비를 위해 우선 저장소를 생성하고 파일을 추가한 뒤 커밋한다.

![image](https://user-images.githubusercontent.com/106071689/201470830-a0afceb9-13e4-4967-913a-1e70eba1b668.png) 

![image](https://user-images.githubusercontent.com/106071689/201470855-b6823ee7-ca80-4327-a167-d1f745cc3c27.png)

그 후 feature 브랜치를 생성후 이동을 해서 파일을 추가해주고 커밋해준다. 

![image](https://user-images.githubusercontent.com/106071689/201470908-a2357bb8-37c3-4e40-90be-adc17cba67d0.png) 

커밋 로그를 확인해보면, feature브랜치가 master 브랜치에서 분리되어 있어 Add bbb, Add ccc 커밋 작업을 두 번 수행한 것을 확인할 수 있다. 

![so3](https://user-images.githubusercontent.com/106071689/201479335-74f23c61-04c0-4666-bf5e-2d18aa32ab7a.PNG)

소스트리를 확인해보면 main과 feature는 서로 다른 브랜치이지만 순차적으로 커밋을 했기 때문에 브랜치 경로가 일직선으로 1개만 있다. 이런 모양의 브랜치에서 병합 작업을 할 때는 
**Fast-Forward 방식의 알고리즘이 적용**된다.

### 병합
    $ git merge 브랜치이름
merge 명령어는 **현재 브랜치를 기준**으로 다른 브랜치의 모든 커밋을 병합한다. 

![image](https://user-images.githubusercontent.com/106071689/201479970-b696e946-382b-4c2a-8941-08f45018e6e2.png)


브랜치를 병합하려면 기준과 대상이 있어야 한다. **기준은 현재 브랜치**이다. 따라서 기준이 되는 브랜치로 main으로 이동 한 뒤 명령어 merge 로 feature 브랜치를 main 브랜치에 병합했다. 메세지를 확인해보면 Fast-Forward 방식을 사용하여 병합하였다고 출력된다.

![so4](https://user-images.githubusercontent.com/106071689/201480098-f2f972c8-c919-4e7f-bcf4-71113c184995.PNG)

소스트리를 확인해보면 masin 브랜치의 마지막 커밋 위치와 feature 브랜치의 마지막 커밋 위치가 같다. 동일한 HEAD 포인터를 가지게 된다.

![image](https://user-images.githubusercontent.com/106071689/201479955-66fcc558-21b4-47d9-bdb7-7429f57b2ed7.png)

커밋 내역을 확인해보면 작업한 브랜치의 시작 커밋을 원본 브랜치 이후의 커밋으로 가리킨다. Fast-Forward 방식 병합은 **단순히 커밋 위치를 최신으로 옮기는 것과 비슷**하다.

<hr>

### 4.4.2 3-way merge

3-way 병합은 좀 더 복잡한 병합을 처리하는 방법이다. 여러 개발자와 협업하는 경우 대부분 3-way 병합을 사용한다.

3-way 병합의 예시도 간단하게 실행해보겠다.  

새로 작업할 hotfix 브랜치를 생성하고, hotfix브랜치로 체크아웃한다.

![SmartSelect_20221113_015328_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485264-2f3edcad-f13e-4dd8-bad8-5d56f03f0c6b.jpg)

소스 코드에 footer 태그를 추가한다.

![SmartSelect_20221113_015328_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485383-72f6a9b3-cbcb-41f3-90bb-2eace0dfb1a8.jpg)  

수정한 파일은 modified 상태가 되기 때문에 스테이지에 등록하고 커밋한다. 

![SmartSelect_20221113_015831_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485503-3c65ce77-6713-4ab0-a604-6cad289bd215.jpg) 

다시 footer 태그 안에 내용을 추가하고 커밋한다. 

![SmartSelect_20221113_020059_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485629-892e19de-844d-47f8-ae36-a189b682466b.jpg)

이 과정을 그림으로 나타내면 이러하다. 

![SmartSelect_20221113_020133_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485642-e9c6019f-120b-4662-90b9-8e7006019f7b.jpg)

소스트리에서 커밋 로그 기록을 확인하면 다음과같다.

![SmartSelect_20221113_020239_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485763-3d03fc20-82f3-448b-ab1f-ee083e6b07f5.jpg)

현재까지 과정은 Fast-Forward와 유사하다. 이제 master 브랜치에도 새로운 커밋을 추가해 보겠다. 

![SmartSelect_20221113_020552_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485915-359570d8-0497-45b6-99c3-982c0f4008e8.jpg)

master 브랜치의 index.html 파일에 menu3를 추가하고 커밋한다. 

![SmartSelect_20221113_020838_Samsung Notes](https://user-images.githubusercontent.com/106071689/201485981-e90ffbec-7783-4379-bca6-820c4ed69e3e.jpg)

다시한번 menu4를 추가하고 커밋한다. 

![SmartSelect_20221113_020938_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486051-397ac417-1303-4697-954e-76c77c80d636.jpg)
![SmartSelect_20221113_021000_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486052-f065c32c-3c25-40c0-ba59-7f8cf1f38bb9.jpg)

이제 기준 커밋에서 서로 다른 브랜치의 커밋이 연결된다. 

![SmartSelect_20221113_021056_Samsung Notes_1](https://user-images.githubusercontent.com/106071689/201486099-95158f67-d2a6-4d79-b90e-aff11f1368ee.jpg)

소스트리에서 확인해보면 Fast-Forward 병합과는 달리 브랜치가 좀 더 확실하게 나위어 있다. 

![SmartSelect_20221113_021139_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486131-902f0a2e-955a-4bda-8edd-1e0b27025779.jpg)


두 브랜치의 공통 커밋(공통 조상 커밋)을 찾아야 한다. 공통 조상 커밋을 포함하는 브랜치, 새로운 두 브랜치, 이렇게 3개를 하나로 병합해야한다. **브랜치가 3개 있다고 해서 3-way 병합**이라고 한다. 

![SmartSelect_20221113_021642_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486345-d8d79399-0064-4b95-891a-afe30ff878c7.jpg)

깃은 3-way 병합을 할 때 공통 조상 커밋을 자동으로 찾아준다. 병합을 성공적으로 완료하면 새로운 커밋을 추가로 하나 생성한다. 새로 생성된 커밋을 **병합 커밋**이라고 한다. 
병합 커밋은 **부모 커밋이 2개**라는 특징이 있다. 

![SmartSelect_20221113_021849_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486459-bf75443f-23dd-4548-9476-b4aea751715b.jpg) 

hotfix브랜치를 병합하려면 기준이되는 master 브랜치로 체크아웃해야 한다. 

![SmartSelect_20221113_022056_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486545-51279c68-cdef-440b-bab6-83d0d72a4078.jpg)

3-way 방식으로 hotfix 브랜치와 master 브랜치를 병합했다. 그림으로 구조를 나타내보면 아래와 같다. 

![SmartSelect_20221113_022215_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486629-c4c1088a-4fbb-4785-9e21-c8b1caae0ed4.jpg)

병합이 성공적으로 된 로그와 소스트리를 확인해본다. 

![SmartSelect_20221113_022313_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486670-6509580c-0fd0-49c2-96d8-b94a364b89bf.jpg)

![SmartSelect_20221113_022330_Samsung Notes](https://user-images.githubusercontent.com/106071689/201486677-506e17d8-0912-4e4a-963f-2c4c486f0e08.jpg)
